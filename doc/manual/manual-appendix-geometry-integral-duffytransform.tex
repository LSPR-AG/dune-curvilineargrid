\subsection{Duffy Transform}
\label{section-abstract-duffy-transform}

The \textit{Duffy} transform is is a bijective map between the local coordinate of a hypercube and another entity, in our case, the reference simplex. Further, one can use the \textit{Duffy} transform to directly apply the hypercubic integration routines (e.g. tensor product quadrature rules) to simplex domains. Effectively, the \textit{Duffy} transform claims that
\[\int_{\triangle} f(\vec{x}) d\vec{x} = \int_{\Box} g(\vec{\tau}) f(\vec{x}(\vec{\tau})) d\vec{\tau},\]
giving explicit expressions for $g(\vec{\tau})$ and $\vec{x}(\vec{\tau})$. \\

\noindent
We consider simplices of all dimensions up to 3: \\

\noindent
\textbf{1D}: The reference hypercube and simplex are both an edge defined on $[0, 1]$, so they have exactly the same parameter. \\

\noindent
\textbf{2D}: Here we map from reference triangle to reference square. We transform the integral of interest, namely

\[ \int_0^1 \int_0^{1-x} f \biggl(
\begin{matrix}  x \\ y  \end{matrix} \biggr)
 dx dy = \int_0^1 \int_0^1 (1-x) 
f \biggl( \begin{matrix} x \\ (1-x)t \end{matrix} \biggr)
dx dt \]

\noindent
using a substitution $t = y / (1 - x)$, such that $t \in [0, 1]$. \\

\noindent
\textbf{3D}: Here we map from the reference tetrahedron to the reference cube. We transform the integral of interest, namely

\[ \int_0^1 \int_0^{1-x} \int_0^{1-x-y} f \scalebox{1.2}{\Bigg(}
\begin{matrix}  x \\ y \\ z  \end{matrix} \scalebox{1.2}{\Bigg)}
dx dy = \int_0^1 \int_0^1 \int_0^1 (1-x)^2 (1-t)
f \scalebox{1.2}{\Bigg(} \begin{matrix}  x \\ (1-x)t \\ (1-x)(1-t)\tau  \end{matrix} \scalebox{1.2}{\Bigg)}
dx dt d\tau \]

\noindent
using a substitution $t = \frac{y}{1 - x}, \tau = \frac{z}{(1 - x)(1 - t)}$, such that $t,\tau \in [0, 1]$. \\