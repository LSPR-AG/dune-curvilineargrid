%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%% objective - CSCS small project proposal
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%\documentclass[a4paper,twocolumn]{article}
%\documentclass[a4paper,10pt]{article}
\documentclass[12pt]{report}

\usepackage[sort&compress,super]{natbib}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
%\usepackage{subfigure}                                %% for creating nested figures within figures
\usepackage{graphicx}
\usepackage{url}
\usepackage{array}
\usepackage{algorithm,algorithmic}
\usepackage{tikz}
\usepackage{url}  
\usetikzlibrary{arrows}
\usetikzlibrary{mindmap,trees}
\usepackage[overlay,absolute]{textpos}
%\usepackage[latin1]{inputenc}
\usepackage{wrapfig}
\usepackage{makeidx}
\usepackage{listings}
\usepackage{color}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage[normalem]{ulem}
\usepackage{mathtools}
\usepackage{lscape}
\usepackage{hyperref}


\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}


% Rounded boxes functionality
\usepackage[framemethod=tikz]{mdframed}
\definecolor{mycolor}{rgb}{0.122, 0.435, 0.698}

\newmdenv[innerlinewidth=0.5pt, roundcorner=4pt,linecolor=mycolor, backgroundcolor=lightgray, innerleftmargin=4pt,
innerrightmargin=4pt,innertopmargin=2pt,innerbottommargin=2pt]{mybox}



%\usepackage[colorlinks,linkcolor=blue,anchorcolor=blue,citecolor=green]{hyperref} % hyper reference to contents 

\citestyle{plain}

\makeindex



% The following parameters seem to provide a reasonable page setup.
\topmargin 0.0cm
\oddsidemargin 0.2cm
\textwidth 16.1cm 
\textheight 21cm
\footskip 1.0cm



\begin{document}

\lstset{language=C++, breaklines=true}



\begin{titlepage}




\begin{center}
    
\noindent \textsc{{\Large Dune-CurvilinearGrid}}

\vspace{5mm}

\noindent \textbf{\textsc{{\Large Parallel grid for unstructured tetrahedral curvilinear meshes}}}
  
\vspace{2mm}
    
{\large
    
\noindent Aleksejs Fomins$^{\mathrm{a,b}}$ and Benedikt Oswald$^{\mathrm{b}}$

  }

\vspace{1mm}

\noindent $^{\mathrm{a}}$ Nanophotonics and Metrology Laboratory (\texttt{nam.epfl.ch})
\noindent Ecole Polytechnique F\'ederale de Lausanne (EPFL)
  
\vspace{1mm}

\noindent $^{\mathrm{b}}$ LSPR AG, Technopark Z\"urich, Technoparkstrasse 1, CH-8005 Z\"urich
\noindent phone +41 43 366 90 74 - email: \texttt{aleksejs.fomins@lspr.ch} and \texttt{benedikt.oswald@lspr.ch}

\vspace{2mm}

\end{center}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ACKNOWLEDGEMENTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\vspace{15mm}
\noindent \textbf{Acknowledgements} - While the architecture, implementation and down-to-earth programming
work for \texttt{dune-curvilineargrid} grid manager is credited with Aleksejs Fomins and Benedikt Oswald,
both of them are pleased to acknowledge the inspiration and support from the wider
\text{DUNE} community. We mention names in alphabetical order and sometimes associated with a specific
subject. In case we have forgotten to acknowledge an important contributor we kindly ask you to inform us and we will be
happy to insert the name immediately. So, then, here we are:
%%
%%
\textit{Peter Bastian}, Professor at University of Heidelberg, Germany
initial suggestion to consider curvilinear tetrahedral grids in order to reduce the computational burden onto the complex linear solver;
%%
%%
\textit{Markus Blatt}, Heidelberg, Germany, based independent high performance computing and \text{DUNE} contractor,
numerous hints related to the build system and \text{DUNE} architecture;
%%
%%
\textit{Andreas Dedner}, professor, University of Warwick, United Kingdom,
numerous hints related to the \text{DUNE} architecture;
%%
%%
\textit{Jorrit 'Hippi Joe' Fahlke}, postdoctoral scientist, University of M\"unster, Germany,
numerous hints related to the \text{DUNE} architecture, grid API, grid testing
and many other fields;
%%
%%
\textit{Dominic Kempf}, Phd student, University of Heidelberg, Germany
support w.r.t grid API implementation in \text{DUNE};
%%
%%
\textit{Robert Kloefkorn}, senior research scientist, IRISI, Norway,
support w.r.t grid API implementation in \text{DUNE};
%%
%%
\textit{Martin Nolte}, postdoctoral scientist, University of Freiburg im Breisgau, Germany,
numerous hints related to the \text{DUNE} architecture;
%%
%%
\textit{Oliver Sander}, professor, TU Aachen, Germany,
numerous hints related to the \text{DUNE} architecture,
numerical integration and quadrature;





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BY WHOM DEVELOPMENT WAS SPONSORED
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\vspace{20mm}
{\small
\noindent \textbf{LEGAL NOTICE} - The development of the \texttt{dune-curvilineargrid} grid manager is sponsored by \textbf{LSPR AG},
Technopark Z\"urich, Technoparkstrasse 1, CH-8005 Z\"urich. \textbf{LSPR AG} exclusively holds all rights associated with \texttt{dune-curvilineargrid}.
%%
%%
The \texttt{dune-curvilineargrid} fully parallel grid manager will be made publicly available via \texttt{Github}
and free software based on the GPLv2 license. Other licenses can be negotiated through
\texttt{benedikt.oswald@lspr.ch}.
%%
%%
We herewith exclude any liability on the part of \textbf{LSPR AG} since the software is made available as is. Any user uses the software
at his own risk and by no means \textbf{LSPR AG} assumes any responsibility for harmful consequences or any other damage caused
by the use of the software. In particular, we emphasise that the whole project is governed by Swiss Law and nothing else.  Especially,
we reject any attempt of any other sovereign law to cover what we do.
}









\pagebreak

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BEGIN OF ABSTRACT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vfill

\noindent \textbf{\textsc{ABSTRACT}} - We introduce the \texttt{dune-curvilineargrid} module. The module provides the self-contained, parallel
grid manager \texttt{dune-curvilineargrid} for curvilinear tetrahedral elements up to $5^{\mathrm{th}}$  order and conforms to the \text{DUNE} grid API.
%%
In particular, \texttt{dune-curvilineargrid} is a grid manager in its own right which offers this functionality:
%%
%%
\textbf{(1)} fully parallel mesh input in the \texttt{Gmsh} mesh format, thus we achieve the scalable input of very large meshes;
i.e. when a large mesh is read from disk, every process in the parallel context reads a small piece of the mesh; thus, we avoid the
scalability bottleneck that would arise if the whole mesh were read on the master process and then communicated to other processes;
the latter approach would inevitably lead to memory congestion on the master node and crash the program;
%%
%%
\textbf{(2)} once the mesh has been read from disk, it is partitioned using the \texttt{Parmetis} graph partitioning tool;
%%
%%
\textbf{(3)} \texttt{dune-curvilineargrid} manages meshes that consist of tetrahedra with curvilinear faces and edges, up to
$5^{\mathrm{th}}$ order; the curvilinear mesh geometry is modelled through \textit{Lagrange} polynomials of the respective order;
%%
%%
\textbf{(4)} since \texttt{dune-curvilineargrid} is a fully parallel grid manager for distributed memory architectures, it provides
globally unique indices over all processes in the parallel context.
%%
%%
\textbf{(5)} the \texttt{dune-curvilineargrid} fully parallel grid manager provides ghost elements associated with the interprocessor
boundaries;
%%
%%
\textbf{(5)} the \texttt{dune-curvilineargrid} grid manager provides communication protocols via the standard
\text{DUNE} data handle interface for all codimensions; i.e. data associated with vertices, edges, faces and volumes can
be communicated.
%%
%%
%%
%%
The \texttt{dune-curvilineargrid} grid manager is continously developed and improved. Among other things, we are working
on local refinement, modelling hanging nodes, non-uniform curvilinear order, periodicity and internal boundaries which
may become interesting for the implementation of hybrid finite-element-boundary-integral (FEBI) discretisation schemes.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% END OF ABSTRACT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\end{titlepage}


\tableofcontents





\chapter{Introduction}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Curvilinear Grid Outline - Section on capabilities of the Grid
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\include{manual-outline}









\chapter{Usage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Curvilinear Grid Howto - Section on tutorials
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\include{manual-tutorials}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Curvilinear Grid Diagnostics - Section on mesh statistics and visualisation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\include{manual-diagnostics}









\chapter{Interface - Curvilinear Geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Polynomial Class
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-polynomial}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Curvilinear Geometry Helper
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-helper}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Interpolator Class
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-interpolation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Recursive Integration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-recursiveintegration}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Recursive Integration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-quadratureintegrator}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Curvilinear Geometry
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-curvilineargeometry}





\chapter{Interface - Curvilinear Grid}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of Curvilinear Grid Factory
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-interface-curvilineargrid}

\section{Curvilinear Grid Base Implementation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of Curvilinear Grid Factory
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-interface-factory}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of Curvilinear GMSH Reader
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-interface-curvilineargmshreader}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of Curvilinear VTK Writer
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-interface-vtkwriter}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of AllCommunication 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-interface-allcommunicate}







\chapter{Theory}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theory for Lagrange Polynomials
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-theory-lagrange}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theory for global and local mappings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-theory-mapping}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theory for integration over curvilinear entities
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-theory-integration}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theory for point location (OCTree)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-octree}






\chapter{Implementation Details}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Details - Curvilinear Element Interpolator
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\include{manual-impl-geometry-curvilineargeometry}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Details - Curvilinear GMSH Reader
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\include{manual-gmshwriter-impl}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Details - Curvilinear Grid Constructor
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\include{manual-constructor}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Details - Curvilinear VTK Writer
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\include{manual-vtkwriter}







\appendix

\chapter{Proofs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Proof of polynomial integral over simplex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{manual-geometry-appendix-polynomialintegralproof}









%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Bibliography
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%\bibliographystyle{plainnat}
%\bibliography{oswald,numerical_libraries,molecular_plasmonics,finite_element_method,electromagnetic}


\printindex

\end{document}