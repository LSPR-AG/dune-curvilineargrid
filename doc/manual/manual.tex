%\documentclass[a4paper,twocolumn]{article}
\documentclass[a4paper,11pt]{book}

\usepackage[sort&compress,super]{natbib}
\usepackage[english]{babel}
\usepackage{amsmath, esint}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{tabularx}                                 %% for tabulars with controllable width
\usepackage{caption}
\usepackage{subcaption}
%\usepackage{subfigure}                                %% for creating nested figures within figures
\usepackage{url}
\usepackage{array}
\usepackage{algorithm,algorithmic}
\usepackage{tikz}
\usepackage{url}  
\usetikzlibrary{arrows}
\usetikzlibrary{mindmap,trees}
\usepackage[overlay,absolute]{textpos}
%\usepackage[latin1]{inputenc}
\usepackage{wrapfig}
\usepackage{makeidx}
\usepackage{listings}
\usepackage{color}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage[normalem]{ulem}
\usepackage{mathtools}
\usepackage{lscape}
\usepackage{hyperref}
\usepackage[nameinlink]{cleveref}         %% Allows referencing subfigures. Must be loaded after hyperref

\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}


% Rounded boxes functionality
\usepackage[framemethod=tikz]{mdframed}
\definecolor{mycolor}{rgb}{0.122, 0.435, 0.698}

\newmdenv[innerlinewidth=0.5pt, roundcorner=4pt,linecolor=mycolor, backgroundcolor=lightgray, innerleftmargin=4pt,
innerrightmargin=4pt,innertopmargin=2pt,innerbottommargin=2pt]{mybox}

%\usepackage[colorlinks,linkcolor=blue,anchorcolor=blue,citecolor=green]{hyperref} % hyper reference to contents 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Citation Shorthands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\citestyle{plain}

\newcommand{\citeParMetis}{\cite{schloegel+2002, lasalle+2013}}
\newcommand{\citeGMSH}{\cite{geuzaine+2009}}
\newcommand{\citeGMSHCurv}{\cite{johnen+2012, toulorge+2013}}
\newcommand{\citeDune}{\cite{bastian+2008}}
\newcommand{\citeSuperLUDist}{\cite{li+2003}}











\makeindex



% The following parameters seem to provide a reasonable page setup.
\topmargin -1.0cm
\oddsidemargin 0cm
\evensidemargin 0cm
\textwidth 16.1cm 
\textheight 21cm
\footskip 1.0cm



\begin{document}

\lstset{language=C++, breaklines=true}



\begin{titlepage}




\begin{center}
    
\noindent \textsc{{\Large Dune-CurvilinearGrid}}

\vspace{5mm}

\noindent \textbf{\textsc{{\Large Parallel Dune Grid Manager for\\Unstructured Tetrahedral Curvilinear Meshes}}}
  
\vspace{2mm}
    
{\large
    
\noindent Aleksejs Fomins$^{\mathrm{a,b}}$ and Benedikt Oswald$^{\mathrm{b}}$

  }

\vspace{1mm}

\noindent $^{\mathrm{a}}$ Nanophotonics and Metrology Laboratory (\texttt{nam.epfl.ch})
\noindent Ecole Polytechnique F\'ederale de Lausanne (EPFL)
  
\vspace{1mm}

\noindent $^{\mathrm{b}}$ LSPR AG, Grubenstrasse 9, CH-8045 Z\"urich.
\noindent phone +41 43 366 90 74 - email: \texttt{aleksejs.fomins@lspr.ch} and \texttt{benedikt.oswald@lspr.ch}

\vspace{2mm}

%%\textbf{WEBSITE}

\end{center}











\pagebreak

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BEGIN OF ABSTRACT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vfill

\noindent \textbf{\textsc{ABSTRACT}} - We introduce the \texttt{dune-curvilineargrid} module. The module provides the self-contained, parallel grid manager \texttt{dune-curvilineargrid}, as well as the underlying elementary curvilinear geometry class \texttt{dune-curvilineargeometry}. Both modules are developed as extension of \text{DUNE} \citeDune project, and conform to the corresponding standard interface. We expect the reader to be at least briefly familiar with the Dune interface to fully benefit from this paper.
%%
This work is carried out by a technology company LSPR AG. It is motivated by reliable and scalable design of nanooptical devices, performed by HADES3D family of electromagnetic codes. It is of primary scientific and industrial interest to model full 3D geometric designs as close to the real fabricated structures as possible. Curvilinear geometries improve both the accuracy of modeling smooth material boundaries, and the convergence rate of PDE solutions with increasing basis function order \cite{fahs2011}, reducing the computational effort required for robust modeling.
%%
\texttt{dune-curvilineargeometry} is capable to model simplex entities (edges, triangles and tetrahedrons) up to polynomial order 5 hard-coded, and up to arbitrary order via analytical procedures. Its most notable features are local-to-global and global-to-local coordinate maps, analytical and adaptive integration, explicit polynomial scalars, vectors and matrices (e.g. Jacobians and Integration Elements).
%%
\texttt{dune-curvilineargrid} module uses \texttt{dune-curvilineargeometry} to provide the following functionality: fully parallel input of curvilinear meshes in the \texttt{gmsh}\citeGMSH mesh format, processing only the corresponding part of the mesh on each available core; mesh partitioning at the reading stag (using \texttt{Parmetis} \citeParMetis); unique global indices for all mesh entities over all processes; ghost elements associated with the interprocessor boundaries; interprocessor communication of data for entities of the mesh of all codimensions via the standard \text{DUNE} data handle interface. There is also significant support for boundary integral codes, allowing arbitrary number of interior boundary surfaces, as well as parallel communication allowing for all-to-all dense coupling procedures.
%%
The \texttt{dune-curvilineargrid} grid manager is continuously developed and improved. Among other things, we are working on higher order basis functions for curvilinear grids, non-uniform adaptive h and p-refinement, periodicity. 
%%
As more work is being done on \texttt{dune-curvilineargrid}, this document will be updated. For the most recent version of the documentation, as well as for the source codes please refer to the following repositories: \\

\noindent
\url{http://www.github.com/lspr-ag/dune-curvilineargeometry}\\
\url{http://www.github.com/lspr-ag/dune-curvilineargrid}\\

\noindent
As well as our website\\

\noindent
\url{http://www.curvilinear-grid.org}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% END OF ABSTRACT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{titlepage}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ACKNOWLEDGEMENTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\pagebreak
\vspace{15mm}
\noindent \textbf{Acknowledgements} - While the architecture, implementation and down-to-earth programming work for \texttt{dune-curvilineargrid} grid manager is credited to Aleksejs Fomins and Benedikt Oswald, both authors are pleased to acknowledge the inspiration and support from the wider \text{DUNE} community. We mention names in alphabetical order and sometimes associated with a specific subject. In case we have forgotten to acknowledge an important contributor we kindly ask you to inform us and we will be happy to insert the name immediately. So, then, here we are:
%%
%%
\textit{Peter Bastian}, Professor at University of Heidelberg, Germany for initial suggestion to consider curvilinear tetrahedral grids in order to reduce the computational burden onto the complex linear solver;
%%
%%
\textit{Markus Blatt}, Heidelberg, Germany, based independent high performance computing and \text{DUNE} contractor, for numerous hints related to the build system and \text{DUNE} architecture;
%%
%%
\textit{Andreas Dedner}, professor, University of Warwick, United Kingdom, for numerous hints related to the \text{DUNE} architecture;
%%
%%
\textit{Jorrit 'Hippi Joe' Fahlke}, postdoctoral scientist, University of M\"unster, Germany, for numerous hints related to the \text{DUNE} architecture, grid API, grid testing and many other fields;
%%
%%
\textit{Dominic Kempf}, Phd student, University of Heidelberg, Germany for support w.r.t grid API implementation in \text{DUNE}, especially w.r.t \textit{CMake};
%%
%%
\textit{Robert Klo\"fkorn}, senior research scientist, IRISI, Norway, for support w.r.t grid API implementation in \text{DUNE};
%%
%%
\textit{Steffen Mu\"thing}, senior research scientist, IRISI, Norway, for support w.r.t grid API implementation in \text{DUNE};
%%
%%
\textit{Martin Nolte}, postdoctoral scientist, University of Freiburg im Breisgau, Germany, for numerous hints related to the \text{DUNE} architecture;
%%
%%
\textit{Oliver Sander}, professor, TU Aachen, Germany, for numerous hints related to the \text{DUNE} architecture, numerical integration and quadrature;




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BY WHOM DEVELOPMENT WAS SPONSORED
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vspace{20mm}
{\small
\noindent \textbf{LEGAL NOTICE} - The development of the \texttt{dune-curvilineargrid} grid manager is sponsored by a technology company \textbf{LSPR AG}, Grubenstrasse 9, CH-8045 Z\"urich, Switzerland. \textbf{LSPR AG} exclusively holds all rights associated with \texttt{dune-curvilineargrid}.
%%
The \texttt{dune-curvilineargrid} fully parallel grid manager will be made publicly available via \texttt{Github} and is a free software based on the GPLv2 license. Other licenses can be negotiated through \texttt{curvilinear-grid@lspr.swiss}.
%%
We herewith exclude any liability on the part of \textbf{LSPR AG} since the software is made available as is. Any user uses the software at his own risk and by no means \textbf{LSPR AG} assumes any responsibility for harmful consequences or any other damage caused by the use of the software. We emphasise that the whole project is governed by Swiss Law and nothing else. Especially, we reject any attempt of any other sovereign law to cover what we do.
}


\tableofcontents


\newpage
\chapter{Introduction}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Curvilinear Grid Outline - Section on capabilities of the Grid
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{manual-outline}





\newpage
\chapter{Theory}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theory for Lagrange Polynomials
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-theory-geometry-lagrange}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theory for global and local mappings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-theory-geometry-mapping}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theory for integration over curvilinear entities
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-theory-geometry-integration}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theory for point location (OCTree)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\input{manual-octree}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Details - Curvilinear GMSH Reader
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Reading Curvilinear Grid}
\input{manual-implementation-gmshreader}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Details - Curvilinear Grid Constructor
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Constructing Curvilinear Grid}
\input{manual-implementation-gridconstructor}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Details - Curvilinear VTK Writer
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Writing Curvilinear Grid}
\input{manual-implementation-gridwriter}



\input{manual-diagnostics}



\chapter{Tutorials}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Curvilinear Grid Howto - Section on tutorials
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{manual-tutorials}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Curvilinear Grid Diagnostics - Section on mesh statistics and visualisation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\input{manual-diagnostics}



\chapter{Testing}







%%\newpage
%%\section{Interface - Curvilinear Geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Interpolator Class
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\input{manual-geometry-interpolation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Recursive Integration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\input{manual-geometry-recursiveintegration}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Recursive Integration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\input{manual-geometry-quadratureintegrator}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Curvilinear Geometry
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\input{manual-geometry-curvilineargeometry}




%\newpage
%\section{Interface - Curvilinear Grid}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of Curvilinear Grid Factory
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\input{manual-interface-curvilineargrid}

%%\section{Curvilinear Grid Base Implementation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of Curvilinear GMSH Reader
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\input{manual-interface-curvilineargmshreader}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of Curvilinear VTK Writer
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\input{manual-interface-vtkwriter}








%%\section{Implementation Details}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Details - Curvilinear Element Interpolator
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\input{manual-impl-geometry-curvilineargeometry}










\appendix

\chapter{Proofs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Proof of explicit expression for the integration elements
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-appendix-geometry-integral-integrationelement}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Proof of polynomial integral over simplex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-appendix-geometry-integral-duffytransform}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Method of dealing with first order singular integrals
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% \input{manual-appendix-geometry-integral-singularityelimination}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Proof of polynomial integral over simplex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-appendix-geometry-polynomialintegralproof}


\chapter{Interfaces}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Polynomial Class
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-appendix-geometry-polynomial}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation of Curvilinear Geometry Helper
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-appendix-geometry-helper}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of Curvilinear Grid Factory
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-appendix-interface-gridfactory}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interface of AllCommunication 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{manual-appendix-interface-allcommunicate}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Bibliography
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\bibliographystyle{plainnat}
\bibliography{bib/oswald,bib/numerical_libraries,bib/finite_element_method,bib/electromagnetic_antenna,bib/electromagnetic_methods,bib/misc,bib/material_properties,bib/interpolation,bib/integration,bib/molecular_plasmonics,bib/numerical_algebra}


\printindex

\end{document}